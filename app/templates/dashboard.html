{% extends 'base.html' %}
{% block content %}
  <h1>Dashboard</h1>

  <section class="card">
    <h2>Yeni Günlük Girişi</h2>
    <form method="post" action="{{ url_for('main.new_entry') }}">
      <textarea name="text" rows="5" placeholder="Bugün nasıldı?" required></textarea>
      <button type="submit" class="btn primary">Kaydet</button>
    </form>
  </section>

  <section>
    <h2>Son Girdiler</h2>
    {% if not entries %}
      <p>Henüz giriş yok.</p>
    {% else %}
      <ul class="entries">
        {% for e in entries %}
          <li class="card">
            <div class="meta">
              <span>{{ e.createdAt or e.created_at }}</span>
            </div>
            <p>{{ e.text }}</p>
            {% if e.analysis %}
              <div class="analysis">
                <div>
                  <strong>Duygu:</strong>
                  skor={{ e.analysis.sentiment.score }}, büyüklük={{ e.analysis.sentiment.magnitude }}
                </div>
                {% if e.analysis.entities %}
                  <div>
                    <strong>Varlıklar:</strong>
                    <ul>
                      {% for ent in e.analysis.entities %}
                        <li>{{ ent.name }} ({{ ent.type }}) — {{ '%.2f'|format(ent.salience) }}</li>
                      {% endfor %}
                    </ul>
                  </div>
                {% endif %}
              </div>
            {% endif %}
          </li>
        {% endfor %}
      </ul>
    {% endif %}
  </section>
{% endblock %}


